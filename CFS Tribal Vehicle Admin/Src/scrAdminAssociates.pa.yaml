# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
#
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
#
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  scrAdminAssociates:
    Properties:
      Fill: =varTheme.Background
      LoadingSpinnerColor: =varTheme.Primary
      OnVisible: |-
        =Set(varActiveScreen, "Associates");
        Set(varShowAssociateForm, false);
        Set(varIsNewAssociate, false);
        Set(varEditAssociate, Blank());
        Set(varSelectedAssociate, Blank());
        Reset(txtAssocSearch);
    Children:
      - cmpAdminNav_Associates:
          Control: CanvasComponent
          ComponentName: cmpAdminNav
          Properties:
            ActiveScreen: ="Associates"
            Height: =Parent.Height
            Width: =220
      - cnrAssocContent:
          Control: GroupContainer@1.4.0
          Variant: ManualLayout
          Properties:
            Fill: =varTheme.Background
            Height: =Parent.Height
            PaddingBottom: =0
            PaddingLeft: =0
            Width: =Parent.Width - 220
            X: =220
          Children:
            - cnrAssocHeader:
                Control: GroupContainer@1.4.0
                Variant: ManualLayout
                Properties:
                  Fill: =varTheme.Surface
                  Height: =64
                  PaddingBottom: =0
                  PaddingLeft: =0
                  Width: =Parent.Width
                Children:
                  - lblAssocTitle:
                      Control: Label@2.5.1
                      Properties:
                        Color: =varTheme.TextPrimary
                        FontWeight: =FontWeight.Bold
                        Height: =40
                        PaddingLeft: =8
                        Size: =20
                        Text: ="Associate Management"
                        Width: =400
                        X: =24
                        Y: =12
                  - lblAssocCount:
                      Control: Label@2.5.1
                      Properties:
                        Color: =varTheme.TextSecondary
                        Height: =20
                        Size: =12
                        Text: =CountRows(Associates) & " associates"
                        Width: =200
                        X: =24
                        Y: =40
                  - btnAddAssociate:
                      Control: Button@0.0.45
                      Properties:
                        Height: =36
                        OnSelect: |-
                          =Set(varIsNewAssociate, true);
                          Set(varEditAssociate, Blank());
                          Set(varSelectedAssociate, Blank());
                          Set(varShowAssociateForm, true)
                        Text: ="+ Add Associate"
                        Width: =150
                        X: =Parent.Width - 174
                        Y: =14
            - cnrAssocFilters:
                Control: GroupContainer@1.4.0
                Variant: ManualLayout
                Properties:
                  Fill: =varTheme.Surface
                  Height: =52
                  PaddingBottom: =0
                  PaddingLeft: =0
                  Width: =Parent.Width
                  Y: =64
                Children:
                  - txtAssocSearch:
                      Control: TextInput@0.0.54
                      Properties:
                        Height: =36
                        Placeholder: ="Search by name, email, or location..."
                        Width: =Parent.Width - 48
                        X: =24
                        Y: =8
            - cnrAssocTableHeader:
                Control: GroupContainer@1.4.0
                Variant: ManualLayout
                Properties:
                  Fill: =varTheme.Background
                  Height: =36
                  PaddingBottom: =0
                  PaddingLeft: =0
                  Width: =Parent.Width
                  Y: =116
                Children:
                  - lblAssocColName:
                      Control: Label@2.5.1
                      Properties:
                        Color: =varTheme.TextSecondary
                        FontWeight: =FontWeight.Semibold
                        Height: =36
                        Size: =11
                        Text: ="Name"
                        Width: =200
                        X: =24
                  - lblAssocColLocation:
                      Control: Label@2.5.1
                      Properties:
                        Color: =varTheme.TextSecondary
                        FontWeight: =FontWeight.Semibold
                        Height: =36
                        Size: =11
                        Text: ="Location"
                        Width: =160
                        X: =224
                  - lblAssocColEmail:
                      Control: Label@2.5.1
                      Properties:
                        Color: =varTheme.TextSecondary
                        FontWeight: =FontWeight.Semibold
                        Height: =36
                        Size: =11
                        Text: ="Email"
                        Width: =240
                        X: =384
                  - lblAssocColPhone:
                      Control: Label@2.5.1
                      Properties:
                        Color: =varTheme.TextSecondary
                        FontWeight: =FontWeight.Semibold
                        Height: =36
                        Size: =11
                        Text: ="Phone"
                        Width: =130
                        X: =624
                  - lblAssocColActions:
                      Control: Label@2.5.1
                      Properties:
                        Align: =Align.Center
                        Color: =varTheme.TextSecondary
                        FontWeight: =FontWeight.Semibold
                        Height: =36
                        Size: =11
                        Text: ="Actions"
                        Width: =120
                        X: =Parent.Width - 144
            - cnrAssocMainArea:
                Control: GroupContainer@1.4.0
                Variant: ManualLayout
                Properties:
                  Fill: =Color.Transparent
                  Height: =Parent.Height - 152
                  PaddingBottom: =0
                  PaddingLeft: =0
                  Width: =Parent.Width
                  Y: =152
                Children:
                  - galAssocTable:
                      Control: Gallery@2.15.0
                      Variant: BrowseLayout_Vertical_OneTextVariant_pcfCore
                      Properties:
                        BorderColor: =varTheme.Border
                        Height: =Parent.Height
                        Items: |-
                          =SortByColumns(
                              Filter(
                                  Associates,
                                  IsBlank(txtAssocSearch.Value) ||
                                  txtAssocSearch.Value in Associate ||
                                  txtAssocSearch.Value in Email ||
                                  txtAssocSearch.Value in Location
                              ),
                              "cr63e_associate",
                              SortOrder.Ascending
                          )
                        LoadingSpinner: =LoadingSpinner.Controls
                        TemplatePadding: =1
                        TemplateSize: =46
                        Width: =If(IsBlank(varSelectedAssociate), Parent.Width, Parent.Width - 380)
                      Children:
                        - cnrAssocTableRow:
                            Control: GroupContainer@1.4.0
                            Variant: ManualLayout
                            Properties:
                              Fill: =If(varSelectedAssociate.Associates = ThisItem.Associates, varTheme.PrimaryLight, varTheme.Surface)
                              Height: =Parent.TemplateHeight - 2
                              PaddingBottom: =0
                              PaddingLeft: =0
                              Width: =Parent.TemplateWidth
                            Children:
                              - recAssocRowAccent:
                                  Control: Rectangle@2.3.0
                                  Properties:
                                    Fill: =If(varSelectedAssociate.Associates = ThisItem.Associates, varTheme.Primary, Color.Transparent)
                                    Height: =Parent.Height
                                    Width: =4
                              - lblAssocRowName:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =varTheme.TextPrimary
                                    FontWeight: =FontWeight.Semibold
                                    Height: =Parent.Height
                                    Size: =12
                                    Text: =ThisItem.Associate
                                    Width: =200
                                    X: =24
                              - lblAssocRowLocation:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =varTheme.TextSecondary
                                    Height: =Parent.Height
                                    Size: =11
                                    Text: =ThisItem.Location
                                    Width: =160
                                    X: =224
                              - lblAssocRowEmail:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =varTheme.TextSecondary
                                    Height: =Parent.Height
                                    Size: =11
                                    Text: =ThisItem.Email
                                    Width: =240
                                    X: =384
                              - lblAssocRowPhone:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =varTheme.TextSecondary
                                    Height: =Parent.Height
                                    Size: =11
                                    Text: =ThisItem.Phone
                                    Width: =130
                                    X: =624
                              - btnAssocEdit:
                                  Control: Button@0.0.45
                                  Properties:
                                    Appearance: ="Secondary"
                                    FontSize: =11
                                    Height: =30
                                    OnSelect: |-
                                      =Set(varIsNewAssociate, false);
                                      Set(varEditAssociate, ThisItem);
                                      Set(varShowAssociateForm, true)
                                    Text: ="Edit"
                                    Width: =46
                                    X: =Parent.Width - 130
                                    Y: =8
                              - btnAssocView:
                                  Control: Button@0.0.45
                                  Properties:
                                    Appearance: ="Transparent"
                                    FontColor: =varTheme.Primary
                                    FontSize: =11
                                    Height: =30
                                    OnSelect: =Set(varSelectedAssociate, ThisItem)
                                    Text: ="View"
                                    Width: =46
                                    X: =Parent.Width - 72
                                    Y: =8
                              - recAssocRowDivider:
                                  Control: Rectangle@2.3.0
                                  Properties:
                                    Fill: =varTheme.Border
                                    Height: =1
                                    Width: =Parent.Width - 24
                                    X: =24
                                    Y: =Parent.Height - 1
                  - cnrAssocDetail:
                      Control: GroupContainer@1.4.0
                      Variant: ManualLayout
                      Properties:
                        Fill: =varTheme.Surface
                        Height: =Parent.Height
                        PaddingBottom: =0
                        PaddingLeft: =0
                        Visible: =!IsBlank(varSelectedAssociate)
                        Width: =380
                        X: =Parent.Width - 380
                      Children:
                        - cnrAssocDetailHeader:
                            Control: GroupContainer@1.4.0
                            Variant: ManualLayout
                            Properties:
                              Fill: =varTheme.PrimaryLight
                              Height: =100
                              PaddingBottom: =0
                              PaddingLeft: =0
                              Width: =Parent.Width
                            Children:
                              - btnCloseAssocDetail:
                                  Control: Button@0.0.45
                                  Properties:
                                    Appearance: ="Transparent"
                                    FontColor: =varTheme.TextSecondary
                                    Height: =30
                                    OnSelect: =Set(varSelectedAssociate, Blank())
                                    Text: ="X"
                                    Width: =30
                                    X: =Parent.Width - 38
                                    Y: =4
                              - icoAssocDetailPerson:
                                  Control: Icon@0.0.7
                                  Properties:
                                    Height: =36
                                    Icon: ="Person"
                                    IconColor: =varTheme.Primary
                                    Width: =36
                                    X: =20
                                    Y: =16
                              - lblAssocDetailName:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =varTheme.TextPrimary
                                    FontWeight: =FontWeight.Bold
                                    Height: =28
                                    Size: =16
                                    Text: =varSelectedAssociate.Associate
                                    Width: =Parent.Width - 80
                                    X: =64
                                    Y: =16
                              - lblAssocDetailEmail:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =varTheme.TextSecondary
                                    Height: =20
                                    Size: =11
                                    Text: =varSelectedAssociate.Email
                                    Width: =Parent.Width - 80
                                    X: =64
                                    Y: =44
                              - lblAssocDetailLocation:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =varTheme.TextSecondary
                                    Height: =20
                                    Size: =11
                                    Text: =varSelectedAssociate.Location & If(!IsBlank(varSelectedAssociate.Phone), "  |  " & varSelectedAssociate.Phone, "")
                                    Width: =Parent.Width - 80
                                    X: =64
                                    Y: =64
                        - lblAssocRecentResTitle:
                            Control: Label@2.5.1
                            Properties:
                              Color: =varTheme.TextPrimary
                              FontWeight: =FontWeight.Semibold
                              Height: =32
                              PaddingLeft: =8
                              Size: =14
                              Text: ="Recent Reservations"
                              Width: =Parent.Width - 32
                              X: =16
                              Y: =108
                        - galAssocReservations:
                            Control: Gallery@2.15.0
                            Variant: BrowseLayout_Vertical_OneTextVariant_pcfCore
                            Properties:
                              BorderColor: =Color.Transparent
                              Height: =200
                              Items: |-
                                =FirstN(
                                    Sort(
                                        Filter(
                                            'Vehicle Reservations',
                                            Associate.Associates = varSelectedAssociate.Associates
                                        ),
                                        StartDateTime,
                                        SortOrder.Descending
                                    ),
                                    5
                                )
                              TemplatePadding: =1
                              TemplateSize: =38
                              Width: =Parent.Width
                              Y: =140
                            Children:
                              - cnrAssocResRow:
                                  Control: GroupContainer@1.4.0
                                  Variant: ManualLayout
                                  Properties:
                                    Fill: =Color.Transparent
                                    Height: =Parent.TemplateHeight - 2
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    Width: =Parent.TemplateWidth
                                  Children:
                                    - lblAssocResVehicle:
                                        Control: Label@2.5.1
                                        Properties:
                                          Color: =varTheme.TextPrimary
                                          FontWeight: =FontWeight.Semibold
                                          Height: =20
                                          Size: =10
                                          Text: =ThisItem.Vehicle.'Vehicle Name'
                                          Width: =Parent.Width - 120
                                          X: =16
                                          Y: =2
                                    - lblAssocResDate:
                                        Control: Label@2.5.1
                                        Properties:
                                          Color: =varTheme.TextSecondary
                                          Height: =16
                                          Size: =9
                                          Text: =Text(ThisItem.StartDateTime, "mmm d") & " - " & Text(ThisItem.EndDateTime, "mmm d, yyyy")
                                          Width: =Parent.Width - 120
                                          X: =16
                                          Y: =20
                                    - lblAssocResStatus:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Right
                                          Color: |-
                                            =Switch(
                                                ThisItem.'Status (cr63e_status)',
                                                'Status (Vehicle Reservations)'.Approved, varStatusColors.Approved,
                                                'Status (Vehicle Reservations)'.Cancelled, varStatusColors.Cancelled,
                                                'Status (Vehicle Reservations)'.Returned, varStatusColors.Available,
                                                varTheme.TextSecondary
                                            )
                                          FontWeight: =FontWeight.Semibold
                                          Height: =20
                                          Size: =9
                                          Text: =Upper(Text(ThisItem.'Status (cr63e_status)'))
                                          Width: =80
                                          X: =Parent.Width - 96
                                          Y: =10
                        - recAssocResDivider:
                            Control: Rectangle@2.3.0
                            Properties:
                              Fill: =varTheme.Border
                              Height: =1
                              Width: =Parent.Width - 32
                              X: =16
                              Y: =344
                        - lblAssocRecentFuelTitle:
                            Control: Label@2.5.1
                            Properties:
                              Color: =varTheme.TextPrimary
                              FontWeight: =FontWeight.Semibold
                              Height: =32
                              PaddingLeft: =8
                              Size: =14
                              Text: ="Recent Fuel Transactions"
                              Width: =Parent.Width - 32
                              X: =16
                              Y: =352
                        - galAssocFuel:
                            Control: Gallery@2.15.0
                            Variant: BrowseLayout_Vertical_OneTextVariant_pcfCore
                            Properties:
                              BorderColor: =Color.Transparent
                              Height: =200
                              Items: |-
                                =FirstN(
                                    Sort(
                                        Filter(
                                            'Fuel Transactions',
                                            SubmittedBy.Associates = varSelectedAssociate.Associates
                                        ),
                                        TransactionDateTime,
                                        SortOrder.Descending
                                    ),
                                    5
                                )
                              TemplatePadding: =1
                              TemplateSize: =38
                              Width: =Parent.Width
                              Y: =384
                            Children:
                              - cnrAssocFuelRow:
                                  Control: GroupContainer@1.4.0
                                  Variant: ManualLayout
                                  Properties:
                                    Fill: =Color.Transparent
                                    Height: =Parent.TemplateHeight - 2
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    Width: =Parent.TemplateWidth
                                  Children:
                                    - lblAssocFuelVehicle:
                                        Control: Label@2.5.1
                                        Properties:
                                          Color: =varTheme.TextPrimary
                                          FontWeight: =FontWeight.Semibold
                                          Height: =20
                                          Size: =10
                                          Text: =ThisItem.Vehicle.'Vehicle Name'
                                          Width: =Parent.Width - 120
                                          X: =16
                                          Y: =2
                                    - lblAssocFuelDate:
                                        Control: Label@2.5.1
                                        Properties:
                                          Color: =varTheme.TextSecondary
                                          Height: =16
                                          Size: =9
                                          Text: =Text(ThisItem.TransactionDateTime, "mmm d, yyyy") & "  |  " & Text(ThisItem.Gallons, "#,##0.0") & " gal"
                                          Width: =Parent.Width - 120
                                          X: =16
                                          Y: =20
                                    - lblAssocFuelAmount:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Right
                                          Color: =varTheme.TextPrimary
                                          FontWeight: =FontWeight.Bold
                                          Height: =20
                                          Size: =10
                                          Text: ="$" & Text(ThisItem.Amount, "#,##0.00")
                                          Width: =80
                                          X: =Parent.Width - 96
                                          Y: =10
      - cnrAssocFormOverlay:
          Control: GroupContainer@1.4.0
          Variant: ManualLayout
          Properties:
            Fill: =RGBA(0, 0, 0, 0.5)
            Height: =Parent.Height
            PaddingBottom: =0
            PaddingLeft: =0
            Visible: =varShowAssociateForm
            Width: =Parent.Width
          Children:
            - cnrAssocFormModal:
                Control: GroupContainer@1.4.0
                Variant: ManualLayout
                Properties:
                  Fill: =varTheme.Surface
                  Height: =420
                  PaddingBottom: =0
                  PaddingLeft: =0
                  RadiusBottomLeft: =12
                  RadiusBottomRight: =12
                  RadiusTopLeft: =12
                  RadiusTopRight: =12
                  Width: =460
                  X: =(Parent.Width - 460) / 2
                  Y: =(Parent.Height - 420) / 2
                Children:
                  - lblAssocFormTitle:
                      Control: Label@2.5.1
                      Properties:
                        Color: =varTheme.TextPrimary
                        FontWeight: =FontWeight.Bold
                        Height: =40
                        PaddingLeft: =8
                        Size: =18
                        Text: =If(varIsNewAssociate, "Add New Associate", "Edit Associate")
                        Width: =360
                        X: =24
                        Y: =16
                  - btnAssocFormClose:
                      Control: Button@0.0.45
                      Properties:
                        Appearance: ="Transparent"
                        FontColor: =varTheme.TextSecondary
                        Height: =36
                        OnSelect: =Set(varShowAssociateForm, false)
                        Text: ="X"
                        Width: =36
                        X: =Parent.Width - 52
                        Y: =16
                  - recAssocFormDivider:
                      Control: Rectangle@2.3.0
                      Properties:
                        Fill: =varTheme.Border
                        Height: =1
                        Width: =Parent.Width - 48
                        X: =24
                        Y: =56
                  - lblAssocFormName:
                      Control: Label@2.5.1
                      Properties:
                        Color: =varTheme.TextPrimary
                        FontWeight: =FontWeight.Semibold
                        Height: =24
                        Size: =12
                        Text: ="Name *"
                        Width: =200
                        X: =24
                        Y: =68
                  - txtAssocFormName:
                      Control: TextInput@0.0.54
                      Properties:
                        Default: =If(!varIsNewAssociate, varEditAssociate.Associate, "")
                        Height: =36
                        Width: =396
                        X: =24
                        Y: =92
                  - lblAssocFormLocation:
                      Control: Label@2.5.1
                      Properties:
                        Color: =varTheme.TextPrimary
                        FontWeight: =FontWeight.Semibold
                        Height: =24
                        Size: =12
                        Text: ="Location"
                        Width: =200
                        X: =24
                        Y: =140
                  - txtAssocFormLocation:
                      Control: TextInput@0.0.54
                      Properties:
                        Default: =If(!varIsNewAssociate, varEditAssociate.Location, "")
                        Height: =36
                        Width: =396
                        X: =24
                        Y: =164
                  - lblAssocFormEmail:
                      Control: Label@2.5.1
                      Properties:
                        Color: =varTheme.TextPrimary
                        FontWeight: =FontWeight.Semibold
                        Height: =24
                        Size: =12
                        Text: ="Email"
                        Width: =200
                        X: =24
                        Y: =212
                  - txtAssocFormEmail:
                      Control: TextInput@0.0.54
                      Properties:
                        Default: =If(!varIsNewAssociate, varEditAssociate.Email, "")
                        Height: =36
                        Width: =190
                        X: =24
                        Y: =236
                  - lblAssocFormPhone:
                      Control: Label@2.5.1
                      Properties:
                        Color: =varTheme.TextPrimary
                        FontWeight: =FontWeight.Semibold
                        Height: =24
                        Size: =12
                        Text: ="Phone"
                        Width: =200
                        X: =230
                        Y: =212
                  - txtAssocFormPhone:
                      Control: TextInput@0.0.54
                      Properties:
                        Default: =If(!varIsNewAssociate, varEditAssociate.Phone, "")
                        Height: =36
                        Width: =190
                        X: =230
                        Y: =236
                  - recAssocFormBottomDivider:
                      Control: Rectangle@2.3.0
                      Properties:
                        Fill: =varTheme.Border
                        Height: =1
                        Width: =Parent.Width - 48
                        X: =24
                        Y: =330
                  - btnAssocFormCancel:
                      Control: Button@0.0.45
                      Properties:
                        Appearance: ="Secondary"
                        Height: =40
                        OnSelect: =Set(varShowAssociateForm, false)
                        Text: ="Cancel"
                        Width: =120
                        X: =Parent.Width - 280
                        Y: =352
                  - btnAssocFormSave:
                      Control: Button@0.0.45
                      Properties:
                        Height: =40
                        OnSelect: |-
                          =Set(varIsSubmitting, true);
                          If(
                              varIsNewAssociate,
                              Patch(
                                  Associates,
                                  Defaults(Associates),
                                  {
                                      Associate: txtAssocFormName.Value,
                                      Location: txtAssocFormLocation.Value,
                                      Email: txtAssocFormEmail.Value,
                                      Phone: txtAssocFormPhone.Value
                                  }
                              ),
                              Patch(
                                  Associates,
                                  varEditAssociate,
                                  {
                                      Associate: txtAssocFormName.Value,
                                      Location: txtAssocFormLocation.Value,
                                      Email: txtAssocFormEmail.Value,
                                      Phone: txtAssocFormPhone.Value
                                  }
                              )
                          );
                          Set(varIsSubmitting, false);
                          Set(varShowAssociateForm, false)
                        Text: =If(varIsSubmitting, "Saving...", If(varIsNewAssociate, "Create Associate", "Save Changes"))
                        Width: =140
                        X: =Parent.Width - 148
                        Y: =352
