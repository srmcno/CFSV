# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
#
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
#
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
#
# CFS Tribal Vehicle Admin — Reports & Analytics
# Desktop layout: 1366x768 with 220px sidebar
# Features: Date range selector, fleet KPI summary cards,
#           vehicle usage table, fuel spend by vehicle gallery (sorted highest-to-lowest)
# ************************************************************************************************
Screens:
  scrAdminReports:
    Properties:
      Fill: =varTheme.Background
      LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
      OnVisible: |-
        =Set(varAdminSection, "Reports");
        Set(varDateRangeStart, DateAdd(Today(), -30, TimeUnit.Days));
        Set(varDateRangeEnd, Today());

        // Fleet utilization: % of vehicles that were checked out at least once in the date range
        Set(
            varFleetUtilization,
            If(
                CountRows(CFSVehicles) > 0,
                RoundUp(
                    CountRows(
                        Distinct(
                            Filter(
                                'Vehicle Checkouts',
                                CheckedOutAt >= varDateRangeStart &&
                                CheckedOutAt <= DateAdd(varDateRangeEnd, 1, TimeUnit.Days)
                            ),
                            Vehicle.CFSVehicles
                        )
                    ) / CountRows(CFSVehicles) * 100,
                    0
                ),
                0
            )
        );

        // Total fuel spend in date range
        Set(
            varReportFuelSpend,
            Sum(
                Filter(
                    'Fuel Transactions',
                    TransactionDateTime >= varDateRangeStart &&
                    TransactionDateTime <= DateAdd(varDateRangeEnd, 1, TimeUnit.Days)
                ),
                Amount
            )
        );

        // Average fuel cost per vehicle (that had fuel transactions)
        Set(
            varReportVehiclesWithFuel,
            CountRows(
                Distinct(
                    Filter(
                        'Fuel Transactions',
                        TransactionDateTime >= varDateRangeStart &&
                        TransactionDateTime <= DateAdd(varDateRangeEnd, 1, TimeUnit.Days)
                    ),
                    Vehicle.CFSVehicles
                )
            )
        );
        Set(
            varReportAvgFuelPerVehicle,
            If(varReportVehiclesWithFuel > 0, varReportFuelSpend / varReportVehiclesWithFuel, 0)
        );

        // Maintenance completion rate
        Set(
            varReportMaintTotal,
            CountRows(
                Filter(
                    'Vehicle Maintenances',
                    ReportedDateTime >= varDateRangeStart &&
                    ReportedDateTime <= DateAdd(varDateRangeEnd, 1, TimeUnit.Days)
                )
            )
        );
        Set(
            varReportMaintClosed,
            CountRows(
                Filter(
                    'Vehicle Maintenances',
                    ReportedDateTime >= varDateRangeStart &&
                    ReportedDateTime <= DateAdd(varDateRangeEnd, 1, TimeUnit.Days) &&
                    'Status (cr63e_status)' = 'Status (Vehicle Maintenances)'.Closed
                )
            )
        );
        Set(
            varReportMaintRate,
            If(varReportMaintTotal > 0, RoundUp(varReportMaintClosed / varReportMaintTotal * 100, 0), 0)
        );

        // Build vehicle usage collection
        ClearCollect(
            colVehicleUsage,
            AddColumns(
                CFSVehicles,
                "_TotalCheckoutDays",
                    Sum(
                        Filter(
                            'Vehicle Checkouts',
                            Vehicle.CFSVehicles = CFSVehicles[@CFSVehicles] &&
                            CheckedOutAt >= varDateRangeStart &&
                            CheckedOutAt <= DateAdd(varDateRangeEnd, 1, TimeUnit.Days)
                        ),
                        If(
                            IsBlank(ReturnedAt),
                            DateDiff(CheckedOutAt, Now(), TimeUnit.Days),
                            DateDiff(CheckedOutAt, ReturnedAt, TimeUnit.Days)
                        )
                    ),
                "_TotalReservations",
                    CountRows(
                        Filter(
                            'Vehicle Reservations',
                            Vehicle.CFSVehicles = CFSVehicles[@CFSVehicles] &&
                            StartDateTime >= varDateRangeStart &&
                            StartDateTime <= DateAdd(varDateRangeEnd, 1, TimeUnit.Days)
                        )
                    ),
                "_TotalFuelSpend",
                    Sum(
                        Filter(
                            'Fuel Transactions',
                            Vehicle.CFSVehicles = CFSVehicles[@CFSVehicles] &&
                            TransactionDateTime >= varDateRangeStart &&
                            TransactionDateTime <= DateAdd(varDateRangeEnd, 1, TimeUnit.Days)
                        ),
                        Amount
                    ),
                "_TotalMaintItems",
                    CountRows(
                        Filter(
                            'Vehicle Maintenances',
                            Vehicle.CFSVehicles = CFSVehicles[@CFSVehicles] &&
                            ReportedDateTime >= varDateRangeStart &&
                            ReportedDateTime <= DateAdd(varDateRangeEnd, 1, TimeUnit.Days)
                        )
                    )
            )
        );

        // Fuel spend by vehicle (sorted highest to lowest for chart gallery)
        ClearCollect(
            colFuelByVehicle,
            Sort(
                AddColumns(
                    Distinct(
                        Filter(
                            'Fuel Transactions',
                            TransactionDateTime >= varDateRangeStart &&
                            TransactionDateTime <= DateAdd(varDateRangeEnd, 1, TimeUnit.Days)
                        ),
                        Vehicle.'Vehicle Name'
                    ),
                    "_Spend",
                        Sum(
                            Filter(
                                'Fuel Transactions',
                                Vehicle.'Vehicle Name' = Value &&
                                TransactionDateTime >= varDateRangeStart &&
                                TransactionDateTime <= DateAdd(varDateRangeEnd, 1, TimeUnit.Days)
                            ),
                            Amount
                        )
                ),
                _Spend,
                SortOrder.Descending
            )
        );
    Children:
      # ── LEFT SIDEBAR NAV ──
      - cmpAdminNav_Reports:
          Control: CanvasComponent
          ComponentName: cmpAdminNav
          Properties:
            ActiveKey: ="Reports"
            Height: =Parent.Height
            Width: =220

      # ── MAIN CONTENT AREA ──
      - cnrReportMain:
          Control: GroupContainer@1.4.0
          Variant: AutoLayout
          Properties:
            Fill: =varTheme.Background
            Height: =Parent.Height
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =0
            Width: =Parent.Width - 220
            X: =220
          Children:
            # ── PAGE HEADER ──
            - cnrReportHeader:
                Control: GroupContainer@1.4.0
                Variant: ManualLayout
                Properties:
                  Fill: =varTheme.Surface
                  FillPortions: =0
                  Height: =60
                  Width: =Parent.Width
                Children:
                  - lblReportTitle:
                      Control: Label@2.5.1
                      Properties:
                        Color: =varTheme.TextPrimary
                        FontWeight: =FontWeight.Bold
                        Height: =32
                        Size: =22
                        Text: ="Reports & Analytics"
                        Width: =300
                        X: =24
                        Y: =14
                  - recReportHeaderBorder:
                      Control: Rectangle@2.3.0
                      Properties:
                        Fill: =varTheme.Border
                        Height: =1
                        Width: =Parent.Width
                        Y: =59

            # ── DATE RANGE SELECTOR ──
            - cnrReportDateRange:
                Control: GroupContainer@1.4.0
                Variant: ManualLayout
                Properties:
                  Fill: =varTheme.Surface
                  FillPortions: =0
                  Height: =52
                  Width: =Parent.Width
                Children:
                  - lblRptFrom:
                      Control: Label@2.5.1
                      Properties:
                        Color: =varTheme.TextSecondary
                        Height: =32
                        Size: =12
                        Text: ="Date Range:"
                        Width: =80
                        X: =24
                        Y: =10
                  - dpRptFrom:
                      Control: DatePicker@0.0.46
                      Properties:
                        Height: =32
                        OnChange: =Set(varDateRangeStart, Self.SelectedDate)
                        SelectedDate: =varDateRangeStart
                        Width: =140
                        X: =108
                        Y: =10
                  - lblRptTo:
                      Control: Label@2.5.1
                      Properties:
                        Color: =varTheme.TextSecondary
                        Height: =32
                        Size: =12
                        Text: ="to"
                        Width: =20
                        X: =260
                        Y: =10
                  - dpRptTo:
                      Control: DatePicker@0.0.46
                      Properties:
                        Height: =32
                        OnChange: =Set(varDateRangeEnd, Self.SelectedDate)
                        SelectedDate: =varDateRangeEnd
                        Width: =140
                        X: =286
                        Y: =10
                  - btnRptRefresh:
                      Control: Button@0.0.45
                      Properties:
                        BasePaletteColor: =varTheme.Primary
                        Height: =32
                        OnSelect: |-
                          =// Re-run OnVisible to refresh all report data
                          Select(Parent)
                        Text: ="Refresh"
                        Width: =100
                        X: =444
                        Y: =10

            # ── SCROLLABLE CONTENT ──
            - cnrReportScroll:
                Control: GroupContainer@1.4.0
                Variant: AutoLayout
                Properties:
                  Fill: =Color.Transparent
                  LayoutDirection: =LayoutDirection.Vertical
                  LayoutGap: =16
                  LayoutOverflowY: =LayoutOverflow.Scroll
                  PaddingBottom: =24
                  PaddingLeft: =24
                  PaddingRight: =24
                  PaddingTop: =16
                  Width: =Parent.Width
                Children:
                  # ── KPI SUMMARY CARDS ROW ──
                  - cnrReportKPIs:
                      Control: GroupContainer@1.4.0
                      Variant: AutoLayout
                      Properties:
                        Fill: =Color.Transparent
                        FillPortions: =0
                        Height: =100
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutGap: =12
                        Width: =Parent.Width - 48
                      Children:
                        # KPI: Fleet Utilization
                        - cnrRptKPIUtil:
                            Control: GroupContainer@1.4.0
                            Variant: ManualLayout
                            Properties:
                              Fill: =varTheme.Surface
                              FillPortions: =1
                              RadiusBottomLeft: =8
                              RadiusBottomRight: =8
                              RadiusTopLeft: =8
                              RadiusTopRight: =8
                            Children:
                              - recRptKPIUtilAccent:
                                  Control: Rectangle@2.3.0
                                  Properties:
                                    Fill: =varTheme.Primary
                                    Height: =4
                                    RadiusTopLeft: =8
                                    RadiusTopRight: =8
                                    Width: =Parent.Width
                              - lblRptKPIUtilVal:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =varTheme.Primary
                                    FontWeight: =FontWeight.Bold
                                    Height: =36
                                    Size: =28
                                    Text: =varFleetUtilization & "%"
                                    Width: =Parent.Width - 24
                                    X: =12
                                    Y: =14
                              - lblRptKPIUtilLbl:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =varTheme.TextSecondary
                                    Height: =20
                                    Size: =12
                                    Text: ="Fleet Utilization"
                                    Width: =Parent.Width - 24
                                    X: =12
                                    Y: =50

                        # KPI: Total Fuel Spend
                        - cnrRptKPIFuel:
                            Control: GroupContainer@1.4.0
                            Variant: ManualLayout
                            Properties:
                              Fill: =varTheme.Surface
                              FillPortions: =1
                              RadiusBottomLeft: =8
                              RadiusBottomRight: =8
                              RadiusTopLeft: =8
                              RadiusTopRight: =8
                            Children:
                              - recRptKPIFuelAccent:
                                  Control: Rectangle@2.3.0
                                  Properties:
                                    Fill: =varStatusColors.Warning
                                    Height: =4
                                    RadiusTopLeft: =8
                                    RadiusTopRight: =8
                                    Width: =Parent.Width
                              - lblRptKPIFuelVal:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =varTheme.TextPrimary
                                    FontWeight: =FontWeight.Bold
                                    Height: =36
                                    Size: =28
                                    Text: ="$" & Text(varReportFuelSpend, "#,##0")
                                    Width: =Parent.Width - 24
                                    X: =12
                                    Y: =14
                              - lblRptKPIFuelLbl:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =varTheme.TextSecondary
                                    Height: =20
                                    Size: =12
                                    Text: ="Total Fuel Spend"
                                    Width: =Parent.Width - 24
                                    X: =12
                                    Y: =50

                        # KPI: Avg Fuel Cost Per Vehicle
                        - cnrRptKPIAvgFuel:
                            Control: GroupContainer@1.4.0
                            Variant: ManualLayout
                            Properties:
                              Fill: =varTheme.Surface
                              FillPortions: =1
                              RadiusBottomLeft: =8
                              RadiusBottomRight: =8
                              RadiusTopLeft: =8
                              RadiusTopRight: =8
                            Children:
                              - recRptKPIAvgFuelAccent:
                                  Control: Rectangle@2.3.0
                                  Properties:
                                    Fill: =varStatusColors.Available
                                    Height: =4
                                    RadiusTopLeft: =8
                                    RadiusTopRight: =8
                                    Width: =Parent.Width
                              - lblRptKPIAvgFuelVal:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =varTheme.TextPrimary
                                    FontWeight: =FontWeight.Bold
                                    Height: =36
                                    Size: =28
                                    Text: ="$" & Text(varReportAvgFuelPerVehicle, "#,##0")
                                    Width: =Parent.Width - 24
                                    X: =12
                                    Y: =14
                              - lblRptKPIAvgFuelLbl:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =varTheme.TextSecondary
                                    Height: =20
                                    Size: =12
                                    Text: ="Avg Fuel/Vehicle"
                                    Width: =Parent.Width - 24
                                    X: =12
                                    Y: =50

                        # KPI: Maintenance Completion Rate
                        - cnrRptKPIMaintRate:
                            Control: GroupContainer@1.4.0
                            Variant: ManualLayout
                            Properties:
                              Fill: =varTheme.Surface
                              FillPortions: =1
                              RadiusBottomLeft: =8
                              RadiusBottomRight: =8
                              RadiusTopLeft: =8
                              RadiusTopRight: =8
                            Children:
                              - recRptKPIMaintAccent:
                                  Control: Rectangle@2.3.0
                                  Properties:
                                    Fill: =If(varReportMaintRate >= 80, varStatusColors.Available, If(varReportMaintRate >= 50, varStatusColors.Warning, varStatusColors.CheckedOut))
                                    Height: =4
                                    RadiusTopLeft: =8
                                    RadiusTopRight: =8
                                    Width: =Parent.Width
                              - lblRptKPIMaintVal:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =If(varReportMaintRate >= 80, varStatusColors.Available, If(varReportMaintRate >= 50, varStatusColors.Warning, varStatusColors.CheckedOut))
                                    FontWeight: =FontWeight.Bold
                                    Height: =36
                                    Size: =28
                                    Text: =varReportMaintRate & "%"
                                    Width: =Parent.Width - 24
                                    X: =12
                                    Y: =14
                              - lblRptKPIMaintLbl:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =varTheme.TextSecondary
                                    Height: =20
                                    Size: =12
                                    Text: ="Maint Completion (" & varReportMaintClosed & "/" & varReportMaintTotal & ")"
                                    Width: =Parent.Width - 24
                                    X: =12
                                    Y: =50

                  # ── VEHICLE USAGE TABLE ──
                  - cnrUsageTableCard:
                      Control: GroupContainer@1.4.0
                      Variant: ManualLayout
                      Properties:
                        Fill: =varTheme.Surface
                        FillPortions: =0
                        Height: =Max(280, 48 + CountRows(colVehicleUsage) * 40)
                        RadiusBottomLeft: =8
                        RadiusBottomRight: =8
                        RadiusTopLeft: =8
                        RadiusTopRight: =8
                        Width: =Parent.Width - 48
                      Children:
                        - lblUsageTableTitle:
                            Control: Label@2.5.1
                            Properties:
                              Color: =varTheme.TextPrimary
                              FontWeight: =FontWeight.Semibold
                              Height: =36
                              Size: =14
                              Text: ="Vehicle Usage Summary"
                              Width: =Parent.Width - 32
                              X: =16
                              Y: =4
                        # Column Headers
                        - lblUHdrVehicle:
                            Control: Label@2.5.1
                            Properties:
                              Color: =varTheme.TextSecondary
                              FontWeight: =FontWeight.Semibold
                              Height: =28
                              Size: =11
                              Text: ="VEHICLE"
                              Width: =200
                              X: =16
                              Y: =36
                        - lblUHdrDays:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              Color: =varTheme.TextSecondary
                              FontWeight: =FontWeight.Semibold
                              Height: =28
                              Size: =11
                              Text: ="DAYS CHECKED OUT"
                              Width: =130
                              X: =220
                              Y: =36
                        - lblUHdrResCount:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              Color: =varTheme.TextSecondary
                              FontWeight: =FontWeight.Semibold
                              Height: =28
                              Size: =11
                              Text: ="RESERVATIONS"
                              Width: =110
                              X: =354
                              Y: =36
                        - lblUHdrFuelSpend:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Right
                              Color: =varTheme.TextSecondary
                              FontWeight: =FontWeight.Semibold
                              Height: =28
                              Size: =11
                              Text: ="FUEL SPEND"
                              Width: =110
                              X: =468
                              Y: =36
                        - lblUHdrMaintCount:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              Color: =varTheme.TextSecondary
                              FontWeight: =FontWeight.Semibold
                              Height: =28
                              Size: =11
                              Text: ="MAINTENANCE"
                              Width: =100
                              X: =582
                              Y: =36
                        - recUsageHeaderLine:
                            Control: Rectangle@2.3.0
                            Properties:
                              Fill: =varTheme.Border
                              Height: =1
                              Width: =Parent.Width - 32
                              X: =16
                              Y: =64
                        # Data Gallery
                        - galUsageTable:
                            Control: Gallery@2.15.0
                            Variant: BrowseLayout_Vertical_OneTextVariant_pcfCore
                            Properties:
                              BorderColor: =Color.Transparent
                              Height: =Parent.Height - 68
                              Items: =Sort(colVehicleUsage, _TotalCheckoutDays, SortOrder.Descending)
                              LoadingSpinner: =LoadingSpinner.Controls
                              TemplatePadding: =0
                              TemplateSize: =40
                              Width: =Parent.Width
                              Y: =66
                            Children:
                              - cnrUsageRow:
                                  Control: GroupContainer@1.4.0
                                  Variant: ManualLayout
                                  Properties:
                                    Fill: =If(Mod(ThisItem.ID, 2) = 0, RGBA(249, 249, 249, 1), varTheme.Surface)
                                    Height: =Parent.TemplateHeight
                                    Width: =Parent.TemplateWidth
                                  Children:
                                    - lblURowVehicle:
                                        Control: Label@2.5.1
                                        Properties:
                                          Color: =varTheme.TextPrimary
                                          FontWeight: =FontWeight.Semibold
                                          Height: =Parent.Height
                                          Size: =12
                                          Text: =ThisItem.'Vehicle Name'
                                          Width: =200
                                          X: =16
                                    - lblURowDays:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          Color: =varTheme.TextPrimary
                                          Height: =Parent.Height
                                          Size: =12
                                          Text: =Text(ThisItem._TotalCheckoutDays)
                                          Width: =130
                                          X: =220
                                    - lblURowRes:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          Color: =varTheme.TextPrimary
                                          Height: =Parent.Height
                                          Size: =12
                                          Text: =Text(ThisItem._TotalReservations)
                                          Width: =110
                                          X: =354
                                    - lblURowFuel:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Right
                                          Color: =varTheme.TextPrimary
                                          FontWeight: =FontWeight.Semibold
                                          Height: =Parent.Height
                                          Size: =12
                                          Text: ="$" & Text(ThisItem._TotalFuelSpend, "#,##0.00")
                                          Width: =110
                                          X: =468
                                    - lblURowMaint:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          Color: =If(ThisItem._TotalMaintItems > 0, varStatusColors.Warning, varTheme.TextPrimary)
                                          FontWeight: =If(ThisItem._TotalMaintItems > 0, FontWeight.Semibold, FontWeight.Normal)
                                          Height: =Parent.Height
                                          Size: =12
                                          Text: =Text(ThisItem._TotalMaintItems)
                                          Width: =100
                                          X: =582
                                    - recURowDivider:
                                        Control: Rectangle@2.3.0
                                        Properties:
                                          Fill: =varTheme.Border
                                          Height: =1
                                          Width: =Parent.Width - 32
                                          X: =16
                                          Y: =Parent.Height - 1

                  # ── FUEL SPEND BY VEHICLE (Bar-chart style gallery, sorted highest to lowest) ──
                  - cnrFuelSpendCard:
                      Control: GroupContainer@1.4.0
                      Variant: ManualLayout
                      Properties:
                        Fill: =varTheme.Surface
                        FillPortions: =0
                        Height: =Max(220, 60 + CountRows(colFuelByVehicle) * 40)
                        RadiusBottomLeft: =8
                        RadiusBottomRight: =8
                        RadiusTopLeft: =8
                        RadiusTopRight: =8
                        Width: =Parent.Width - 48
                      Children:
                        - lblFuelSpendTitle:
                            Control: Label@2.5.1
                            Properties:
                              Color: =varTheme.TextPrimary
                              FontWeight: =FontWeight.Semibold
                              Height: =36
                              Size: =14
                              Text: ="Fuel Spend by Vehicle"
                              Width: =Parent.Width - 32
                              X: =16
                              Y: =8
                        - recFuelSpendTitleLine:
                            Control: Rectangle@2.3.0
                            Properties:
                              Fill: =varTheme.Border
                              Height: =1
                              Width: =Parent.Width - 32
                              X: =16
                              Y: =44
                        - galFuelSpendChart:
                            Control: Gallery@2.15.0
                            Variant: BrowseLayout_Vertical_OneTextVariant_pcfCore
                            Properties:
                              BorderColor: =Color.Transparent
                              Height: =Parent.Height - 52
                              Items: =colFuelByVehicle
                              LoadingSpinner: =LoadingSpinner.Controls
                              TemplatePadding: =2
                              TemplateSize: =36
                              Width: =Parent.Width - 32
                              X: =16
                              Y: =48
                            Children:
                              - cnrFuelBarRow:
                                  Control: GroupContainer@1.4.0
                                  Variant: ManualLayout
                                  Properties:
                                    Fill: =Color.Transparent
                                    Height: =Parent.TemplateHeight
                                    Width: =Parent.TemplateWidth
                                  Children:
                                    - lblFuelBarVehicle:
                                        Control: Label@2.5.1
                                        Properties:
                                          Color: =varTheme.TextPrimary
                                          FontWeight: =FontWeight.Semibold
                                          Height: =Parent.Height
                                          Size: =12
                                          Text: =ThisItem.Value
                                          Width: =160
                                    - recFuelBar:
                                        Control: Rectangle@2.3.0
                                        Properties:
                                          Fill: =varTheme.Primary
                                          Height: =20
                                          RadiusBottomLeft: =4
                                          RadiusBottomRight: =4
                                          RadiusTopLeft: =4
                                          RadiusTopRight: =4
                                          Width: |-
                                            =If(
                                                Max(colFuelByVehicle, _Spend) > 0,
                                                Max(20, (ThisItem._Spend / Max(colFuelByVehicle, _Spend)) * (Parent.Width - 340)),
                                                20
                                            )
                                          X: =164
                                          Y: =6
                                    - lblFuelBarAmount:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Right
                                          Color: =varTheme.TextPrimary
                                          FontWeight: =FontWeight.Bold
                                          Height: =Parent.Height
                                          Size: =12
                                          Text: ="$" & Text(ThisItem._Spend, "#,##0.00")
                                          Width: =100
                                          X: =Parent.Width - 100
                        - lblNoFuelData:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              Color: =varTheme.TextSecondary
                              Height: =40
                              Size: =13
                              Text: ="No fuel transactions in selected date range"
                              Visible: =CountRows(colFuelByVehicle) = 0
                              Width: =Parent.Width
                              Y: =80
